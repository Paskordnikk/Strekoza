# Настройка Telegram Bot для выгрузки файлов

## Описание

Приложение теперь поддерживает отправку файлов через Telegram Bot API. Когда пользователь открывает приложение через Telegram Web App и нажимает "Выгрузить", файл автоматически отправляется ему через бота @Streko_Zza_bot.

## Настройка

### 1. Получение токена бота

1. Откройте [@BotFather](https://t.me/BotFather) в Telegram
2. Отправьте команду `/mybots`
3. Выберите вашего бота @Streko_Zza_bot
4. Выберите "API Token"
5. Скопируйте токен (выглядит как `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### 2. Установка токена на сервере

#### Вариант 1: Через переменную окружения (рекомендуется)

**Windows (PowerShell):**
```powershell
$env:TELEGRAM_BOT_TOKEN="ваш_токен_бота"
python server.py
```

**Windows (CMD):**
```cmd
set TELEGRAM_BOT_TOKEN=ваш_токен_бота
python server.py
```

**Linux/Mac:**
```bash
export TELEGRAM_BOT_TOKEN="ваш_токен_бота"
python server.py
```

#### Вариант 2: Через файл .env

1. Создайте файл `.env` в корне проекта:
```
TELEGRAM_BOT_TOKEN=ваш_токен_бота
```

2. Установите `python-dotenv`:
```bash
pip install python-dotenv
```

3. Запустите сервер:
```bash
python server.py
```

#### Вариант 3: Для продакшена (Render.com, Heroku и т.д.)

Добавьте переменную окружения `TELEGRAM_BOT_TOKEN` в настройках вашего хостинга.

## Как это работает

1. Пользователь открывает приложение через Telegram Web App
2. При нажатии на кнопку "Выгрузить" (маршрут или точки):
   - Приложение получает user ID из Telegram Web App
   - Отправляет файл на сервер через API `/api/send_file`
   - Сервер отправляет файл пользователю через Telegram Bot API
   - Пользователь получает файл в чате с ботом

3. В обычном браузере (не Telegram Web App):
   - Файл скачивается стандартным способом через браузер

## Проверка работы

1. Убедитесь, что токен бота установлен:
   - Проверьте логи сервера при запуске
   - Если токен не установлен, вы увидите предупреждение

2. Откройте приложение через Telegram Web App

3. Создайте маршрут или точки и нажмите "Выгрузить"

4. Проверьте чат с ботом @Streko_Zza_bot - файл должен быть там

## Устранение неполадок

### Файл не отправляется

1. Проверьте, что токен бота установлен правильно
2. Убедитесь, что пользователь начал диалог с ботом (отправил `/start`)
3. Проверьте логи сервера на наличие ошибок
4. Убедитесь, что бот не заблокирован пользователем

### Ошибка "Telegram Bot Token не настроен"

Установите переменную окружения `TELEGRAM_BOT_TOKEN` с токеном вашего бота.

### Ошибка "Не удалось отправить файл через бота"

1. Проверьте, что токен бота правильный
2. Убедитесь, что пользователь начал диалог с ботом
3. Проверьте, что бот не заблокирован
4. Убедитесь, что файл не слишком большой (лимит Telegram: 50 МБ)

