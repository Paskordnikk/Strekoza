<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Map</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.polylinemeasure/Leaflet.PolylineMeasure.css" />
</head>
<body>
    <div id="map"></div>
    <div id="measure-control" class="map-control-button">
        <button id="measure-distance-btn" class="map-control-btn">–ò–∑–º–µ—Ä–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ</button>
    </div>
    <div id="route-control" class="map-control-button" style="top: 60px;">
        <button id="build-route-btn" class="map-control-btn">–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç</button>
    </div>
    <div id="import-control" class="map-control-button" style="top: 110px;">
        <button id="import-route-btn" class="map-control-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç</button>
    </div>
    <input type="file" id="csv-importer" accept=".csv" style="display: none;">
    <div id="route-calc-control" class="map-control-button" style="display: none; top: 60px;">
        <button id="calculate-route-btn" class="map-control-btn">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç</button>
    </div>
    <div id="hamburger-menu" class="menu-button">
        <span></span>
        <span></span>
        <span></span>
    </div>
    <button id="debug-toggle" class="debug-button" style="display: none;">üêõ</button>
    <div id="side-menu">
        <div id="close-menu-btn">&times;</div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ -->
        <div class="menu-section">
            <div class="menu-section-title">–û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ä—Ç–∞</div>
            <div class="menu-item">
                <label for="brightness-slider">–Ø—Ä–∫–æ—Å—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ä—Ç—ã</label>
                <input type="range" id="brightness-slider" min="0" max="100" value="100">
            </div>
            <div class="menu-item radio-option">
                <input type="radio" id="base-opentopomap" name="base-map-type" value="opentopomap" checked>
                <label for="base-opentopomap">OpenTopoMap (—Å –≤—ã—Å–æ—Ç–∞–º–∏)</label>
            </div>
            <div class="menu-item radio-option">
                <input type="radio" id="base-thunderforestlandscape" name="base-map-type" value="thunderforestlandscape">
                <label for="base-thunderforestlandscape">–ö–∞—Ä—Ç–∞ —Ä–µ–ª—å–µ—Ñ–∞ —Å –≤—ã—Å–æ—Ç–∞–º–∏</label>
            </div>
            <div class="menu-item radio-option">
                <input type="radio" id="base-cyclosm" name="base-map-type" value="cyclosm">
                <label for="base-cyclosm">–¢—Ä–æ–ø–∏–Ω–∫–∏, –¥–æ—Ä–æ–∂–∫–∏, –≤—ã—Å–æ—Ç—ã</label>
            </div>
            <div class="menu-item radio-option">
                <input type="radio" id="base-monochrome" name="base-map-type" value="monochrome">
                <label for="base-monochrome">–ú–æ–Ω–æ—Ö—Ä–æ–º–Ω–∞—è –∫–∞—Ä—Ç–∞ —Ä–µ–ª—å–µ—Ñ–∞</label>
            </div>
            <div class="menu-item radio-option">
                <input type="radio" id="base-esriworldimagery" name="base-map-type" value="esriworldimagery">
                <label for="base-esriworldimagery">–°–ø—É—Ç–Ω–∏–∫</label>
            </div>
            <div class="menu-item radio-option">
                <input type="radio" id="base-openstreetmap" name="base-map-type" value="openstreetmap">
                <label for="base-openstreetmap">OpenStreetMap</label>
            </div>
            <div class="menu-item radio-option">
                <input type="radio" id="base-cartovoyager" name="base-map-type" value="cartovoyager">
                <label for="base-cartovoyager">–°–≤–µ—Ç–ª–∞—è –∫–∞—Ä—Ç–∞-–ø–æ–¥–ª–æ–∂–∫–∞</label>
            </div>
            <div class="menu-item radio-option">
                <input type="radio" id="base-esriocean" name="base-map-type" value="esriocean">
                <label for="base-esriocean">–ö–∞—Ä—Ç–∞ —Ä–µ–∫ –∏ –æ–∑–µ—Ä</label>
            </div>
            <div class="menu-item radio-option">
                <input type="radio" id="base-nasanight" name="base-map-type" value="nasanight">
                <label for="base-nasanight">–ù–æ—á–Ω–æ–µ –≤—Ä–µ–º—è —Å—É—Ç–æ–∫</label>
            </div>
            <div class="menu-item radio-option">
                <input type="radio" id="base-jawgdark" name="base-map-type" value="jawgdark">
                <label for="base-jawgdark">Dark</label>
            </div>
        </div>

        <!-- –í–µ—Ä—Ö–Ω—è—è –∫–∞—Ä—Ç–∞ -->
        <div class="menu-section">
            <div class="menu-section-title">–í–µ—Ä—Ö–Ω—è—è –∫–∞—Ä—Ç–∞</div>
            <div class="menu-item checkbox-option">
                <input type="checkbox" id="enable-overlay-map">
                <label for="enable-overlay-map">–í–∫–ª—é—á–∏—Ç—å –≤–µ—Ä—Ö–Ω—é—é –∫–∞—Ä—Ç—É</label>
            </div>
            <div id="overlay-map-controls" style="display: none;">
                <div class="menu-item">
                    <label for="overlay-opacity-slider">–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –≤–µ—Ä—Ö–Ω–µ–π –∫–∞—Ä—Ç—ã</label>
                    <input type="range" id="overlay-opacity-slider" min="0" max="100" value="50">
                </div>
                <div class="menu-item radio-option">
                    <input type="radio" id="overlay-opentopomap" name="overlay-map-type" value="opentopomap" checked>
                    <label for="overlay-opentopomap">OpenTopoMap (—Å –≤—ã—Å–æ—Ç–∞–º–∏)</label>
                </div>
                <div class="menu-item radio-option">
                    <input type="radio" id="overlay-thunderforestlandscape" name="overlay-map-type" value="thunderforestlandscape">
                    <label for="overlay-thunderforestlandscape">–ö–∞—Ä—Ç–∞ —Ä–µ–ª—å–µ—Ñ–∞ —Å –≤—ã—Å–æ—Ç–∞–º–∏</label>
                </div>
                <div class="menu-item radio-option">
                    <input type="radio" id="overlay-cyclosm" name="overlay-map-type" value="cyclosm">
                    <label for="overlay-cyclosm">–¢—Ä–æ–ø–∏–Ω–∫–∏, –¥–æ—Ä–æ–∂–∫–∏, –≤—ã—Å–æ—Ç—ã</label>
                </div>
                <div class="menu-item radio-option">
                    <input type="radio" id="overlay-monochrome" name="overlay-map-type" value="monochrome">
                    <label for="overlay-monochrome">–ú–æ–Ω–æ—Ö—Ä–æ–º–Ω–∞—è –∫–∞—Ä—Ç–∞ —Ä–µ–ª—å–µ—Ñ–∞</label>
                </div>
                <div class="menu-item radio-option">
                    <input type="radio" id="overlay-esriworldimagery" name="overlay-map-type" value="esriworldimagery">
                    <label for="overlay-esriworldimagery">–°–ø—É—Ç–Ω–∏–∫</label>
                </div>
                <div class="menu-item radio-option">
                    <input type="radio" id="overlay-openstreetmap" name="overlay-map-type" value="openstreetmap">
                    <label for="overlay-openstreetmap">OpenStreetMap</label>
                </div>
                <div class="menu-item radio-option">
                    <input type="radio" id="overlay-cartovoyager" name="overlay-map-type" value="cartovoyager">
                    <label for="overlay-cartovoyager">–°–≤–µ—Ç–ª–∞—è –∫–∞—Ä—Ç–∞-–ø–æ–¥–ª–æ–∂–∫–∞</label>
                </div>
                <div class="menu-item radio-option">
                    <input type="radio" id="overlay-esriocean" name="overlay-map-type" value="esriocean">
                    <label for="overlay-esriocean">–ö–∞—Ä—Ç–∞ —Ä–µ–∫ –∏ –æ–∑–µ—Ä</label>
                </div>
                <div class="menu-item radio-option">
                    <input type="radio" id="overlay-nasanight" name="overlay-map-type" value="nasanight">
                    <label for="overlay-nasanight">–ù–æ—á–Ω–æ–µ –≤—Ä–µ–º—è —Å—É—Ç–æ–∫</label>
                </div>
                <div class="menu-item radio-option">
                    <input type="radio" id="overlay-jawgdark" name="overlay-map-type" value="jawgdark">
                    <label for="overlay-jawgdark">Dark</label>
                </div>
            </div>
        </div>

        <!-- –°–ª–æ–∏ -->
        <div class="menu-section">
            <div class="menu-section-title">–°–ª–æ–∏</div>
            <div class="menu-item checkbox-option">
                <input type="checkbox" id="enable-roads-layer">
                <label for="enable-roads-layer">–ñ–µ–ª–µ–∑–Ω—ã–µ –¥–æ—Ä–æ–≥–∏</label>
            </div>
            <div id="roads-layer-controls" style="display: none;">
                <div class="menu-item">
                    <label for="roads-opacity-slider">–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Å–ª–æ—è –¥–æ—Ä–æ–≥</label>
                    <input type="range" id="roads-opacity-slider" min="0" max="100" value="100">
                </div>
            </div>
            <div class="menu-item checkbox-option">
                <input type="checkbox" id="enable-borders-layer">
                <label for="enable-borders-layer">–ì—Ä–∞–Ω–∏—Ü—ã</label>
            </div>
            <div id="borders-layer-controls" style="display: none;">
                <div class="menu-item">
                    <label for="borders-opacity-slider">–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Å–ª–æ—è –≥—Ä–∞–Ω–∏—Ü</label>
                    <input type="range" id="borders-opacity-slider" min="0" max="100" value="100">
                </div>
            </div>
            <div class="menu-item checkbox-option">
                <input type="checkbox" id="enable-labels-layer">
                <label for="enable-labels-layer">–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è</label>
            </div>
            <div id="labels-layer-controls" style="display: none;">
                <div class="menu-item">
                    <label for="labels-opacity-slider">–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Å–ª–æ—è –Ω–∞–∑–≤–∞–Ω–∏–π</label>
                    <input type="range" id="labels-opacity-slider" min="0" max="100" value="100">
                </div>
            </div>
        </div>

    </div>
    
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è –≤—ã—Å–æ—Ç—ã -->
    <div id="elevation-profile">
        <div id="profile-header">
            <div id="profile-title-wrapper"></div>
            <div id="profile-buttons-container">
                <button id="step-25-btn" class="step-btn" data-step="25">–®–∞–≥ 25–º</button>
                <button id="step-50-btn" class="step-btn active" data-step="50">–®–∞–≥ 50–º</button>
                <button id="step-100-btn" class="step-btn" data-step="100">–®–∞–≥ 100–º</button>
                <button id="export-route-btn" class="profile-action-btn">–í—ã–≥—Ä—É–∑–∏—Ç—å</button>
                <button id="finish-route-btn" class="profile-action-btn">–ó–∞–∫–æ–Ω—á–∏—Ç—å</button>
            </div>
        </div>
        <div id="profile-chart"></div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/topojson-client@3.1.0/dist/topojson-client.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet.polylinemeasure@latest/Leaflet.PolylineMeasure.js"></script>
    <script src="script.js"></script>

    <script>
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∫–æ–Ω—Å–æ–ª–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        if (isMobile) {
            const debugBtn = document.getElementById('debug-toggle');
            debugBtn.style.display = 'block';
            
            let erudaLoaded = false;
            
            debugBtn.addEventListener('click', function() {
                if (!erudaLoaded) {
                    const script = document.createElement('script');
                    script.src = 'https://cdn.jsdelivr.net/npm/eruda';
                    script.onload = function() {
                        eruda.init();
                        erudaLoaded = true;
                    };
                    document.body.appendChild(script);
                } else {
                    eruda.show();
                }
            });
        }
    </script>

    <div id="geo-error-modal" class="hidden">
        <p>–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ. –í–∫–ª—é—á–∏—Ç–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞.</p>
        <button id="geo-error-cancel">–û–∫</button>
        <div>
            <input type="checkbox" id="geo-error-dont-show">
            <label for="geo-error-dont-show">–ë–æ–ª—å—à–µ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å</label>
        </div>
    </div>
</body>
</html>